# Inner class khi compile có thể leak dữ liệu
Vì trong quá trình compile, các Inner class thay đổi thành khả năng truy cập ở cấp độ package nên việc tiết lộ thông tin ngoài ý muốn có thể xảy ra. 
Để tránh điều này, bạn nên cân nhắc sử dụng inner class tĩnh, inner class cục bộ hoặc inner class ẩn danh.
Khi sử dụng inner class, tránh truy cập vào các trường private của class bên ngoài. 
Nếu có thể, hãy tránh sử dụng các inner class và nếu bạn chắc chắn phải sử dụng các inner class, bạn phải sử dụng các inner class tĩnh, cục bộ hoặc ẩn danh.

# Demonstrative Examples
Vô tình sử dụng một lớp bên trong.
```java
public final class urlTool extends Applet {
    private final class urlHelper {
        ...
    }
    ...
}
```

Lớp bên trong riêng InnerClass bao gồm phương thức concat truy cập các biến thành viên riêng 
của lớp OuterClass để xuất giá trị của một trong các biến thành viên riêng của lớp OuterClass 
và trả về một chuỗi là phép nối của một trong các biến thành viên riêng của lớp OuterClass, 
tham số đầu vào phân cách của phương thức và biến thành viên riêng của lớp InnerClass.
```java
public class OuterClass {
    // private member variables of OuterClass
    private String memberOne;
    private String memberTwo;   // NOT STATIC

    // constructor of OuterClass
    public OuterClass(String varOne, String varTwo) {
        this.memberOne = varOne;
        this.memberTwo = varTwo;
    }

    // InnerClass is a member inner class of OuterClass
    private class InnerClass {
        private String innerMemberOne;

        public InnerClass(String innerVarOne) {
            this.innerMemberOne = innerVarOne;
        }

        public String concat(String separator) {
            // InnerClass has access to private member variables of OuterClass
            System.out.println("Value of memberOne is: " + memberOne);
            return OuterClass.this.memberTwo + separator + this.innerMemberOne;
        }
    }
}
```

Code sau sử dụng fields static của OuterClass
```java
public class OuterClass {

    // private member variables of OuterClass
    private String memberOne;
    private static String memberTwo;    // STATIC

    // constructor of OuterClass
    public OuterClass(String varOne, String varTwo) {
        this.memberOne = varOne;
        this.memberTwo = varTwo;
    }

    // InnerClass is a STATIC inner class of OuterClass
    private static class InnerClass {

        private String innerMemberOne;

        public InnerClass(String innerVarOne) {
            this.innerMemberOne = innerVarOne;
        }
        public String concat(String separator) {
            // InnerClass only has access to static member variables of OuterClass
            return memberTwo + separator + this.innerMemberOne;
        }
    }
}
```

Inner class InterestAdder sử dụng field outer class qua đối tượng BankAccount
-> Có nguy cơ weakness
```java
public class BankAccount {

    // private member variables of BankAccount class
    private String accountOwnerName;
    private String accountOwnerSSN;
    private int accountNumber;
    private double balance;

    // constructor for BankAccount class
    public BankAccount(String accountOwnerName, String accountOwnerSSN,
            int accountNumber, double initialBalance, int initialRate) {
        this.accountOwnerName = accountOwnerName;
        this.accountOwnerSSN = accountOwnerSSN;
        this.accountNumber = accountNumber;
        this.balance = initialBalance;
        this.start(initialRate);
    }

    // start method will add interest to balance every 30 days

    // creates timer object and interest adding action listener object
    public void start(double rate) {
        ActionListener adder = new InterestAdder(rate);
        Timer t = new Timer(1000 * 3600 * 24 * 30, adder);
        t.start();
    }

    // InterestAdder is an inner class of BankAccount class

    // that implements the ActionListener interface
    private class InterestAdder implements ActionListener {
        private double rate;

        public InterestAdder(double aRate) {
            this.rate = aRate;
        }

        public void actionPerformed(ActionEvent event) {
            // update interest
            double interest = BankAccount.this.balance * rate / 100;
            BankAccount.this.balance += interest;
        }
    }
}
```

Code dưới hạn chế inner class bằng giới hạn scope trong method
```java
public class BankAccount {

    // private member variables of BankAccount class
    private String accountOwnerName;
    private String accountOwnerSSN;
    private int accountNumber;
    private double balance;

    // constructor for BankAccount class
    public BankAccount(String accountOwnerName, String accountOwnerSSN,
    int accountNumber, double initialBalance, int initialRate) {
        this.accountOwnerName = accountOwnerName;
        this.accountOwnerSSN = accountOwnerSSN;
        this.accountNumber = accountNumber;
        this.balance = initialBalance;
        this.start(initialRate);
    }

    // start method will add interest to balance every 30 days

    // creates timer object and interest adding action listener object
    public void start(final double rate) {
        // InterestAdder is a local inner class

        // that implements the ActionListener interface
        class InterestAdder implements ActionListener {
            public void actionPerformed(ActionEvent event) {
                // update interest
                double interest = BankAccount.this.balance * rate / 100;
                BankAccount.this.balance += interest;
            }
        }
        ActionListener adder = new InterestAdder();
        Timer t = new Timer(1000 * 3600 * 24 * 30, adder);
        t.start();
    }
}
```