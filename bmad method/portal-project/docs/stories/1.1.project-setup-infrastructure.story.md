# Story 1.1: Project Setup & Infrastructure

## Status
Ready for Review

## Story
**As a** developer,
**I want** a properly configured Next.js backend with PostgreSQL database and Vue.js 3 frontend with PrimeVue,
**so that** I have a solid foundation for building the knowledge portal.

## Acceptance Criteria
1. Next.js project configured with TypeScript and Prisma ORM
2. PostgreSQL database connection established with proper schema
3. Vue.js 3 frontend with Vite, TypeScript, and PrimeVue components
4. Docker configuration for both frontend and backend
5. Basic health check endpoints and frontend routing
6. Development environment setup with hot reloading
7. Git repository initialized with proper .gitignore

## Tasks / Subtasks
- [x] Task 1: Initialize Monorepo Structure (AC: 7)
  - [x] Create root package.json with npm workspaces configuration
  - [x] Set up shared packages structure (packages/shared, packages/config)
  - [x] Initialize Git repository with proper .gitignore
  - [x] Create root README.md with project overview

- [x] Task 2: Backend Setup - Next.js with TypeScript (AC: 1, 5)
  - [x] Create Next.js project in apps/backend with TypeScript
  - [x] Configure Prisma ORM with PostgreSQL connection
  - [x] Set up basic API route structure (/api/health)
  - [x] Configure TypeScript and ESLint for backend
  - [x] Create basic health check endpoint

- [x] Task 3: Database Setup - PostgreSQL Schema (AC: 2)
  - [x] Set up PostgreSQL database connection
  - [x] Create Prisma schema with User, Article, FileAttachment, and Session models
  - [x] Generate and run initial database migrations
  - [x] Set up database indexes and triggers
  - [x] Create seed data for initial admin user

- [x] Task 4: Frontend Setup - Vue.js 3 with PrimeVue (AC: 3, 6)
  - [x] Create Vue.js 3 project in apps/frontend with Vite
  - [x] Configure TypeScript for frontend
  - [x] Install and configure PrimeVue components
  - [x] Set up Pinia for state management
  - [x] Configure Vue Router for basic routing
  - [x] Set up hot reloading development environment

- [x] Task 5: Docker Configuration (AC: 4)
  - [x] Create Dockerfile for backend with multi-stage build
  - [x] Create Dockerfile for frontend with multi-stage build
  - [x] Create docker-compose.yml for local development
  - [x] Configure environment variables for Docker
  - [x] Set up health checks for containers

- [x] Task 6: Development Environment Configuration (AC: 6)
  - [x] Create .env.example files for both frontend and backend
  - [x] Set up development scripts in root package.json
  - [x] Configure concurrent development server startup
  - [x] Set up linting and formatting scripts
  - [x] Create development documentation

- [x] Task 7: Testing Setup (AC: All)
  - [x] Configure Vitest for frontend testing
  - [x] Configure Jest for backend testing
  - [x] Set up Playwright for E2E testing
  - [x] Create basic test examples for each layer
  - [x] Configure test scripts in package.json

## Dev Notes

### Previous Story Insights
No previous stories exist - this is the foundation story.

### Data Models
**User Model** [Source: architecture/data-models.md#User Model]:
- UUID primary key, username, email, passwordHash, role (ADMIN/USER), timestamps
- TypeScript interface with proper typing for role enum

**Database Schema** [Source: architecture/database-schema.md]:
- PostgreSQL tables: users, articles, file_attachments, sessions
- Proper indexes for performance (username, email, title search)
- Triggers for updated_at timestamps
- Foreign key relationships with CASCADE deletes

### API Specifications
**Health Check Endpoint** [Source: architecture/development-workflow.md]:
- GET /api/health - Basic health check for backend status
- Should return 200 OK with basic system status

### Component Specifications
**Frontend Structure** [Source: architecture/unified-project-structure.md]:
- Vue.js 3 with Composition API
- PrimeVue components for UI consistency
- Pinia for state management
- Vue Router for navigation

### File Locations
**Project Structure** [Source: architecture/unified-project-structure.md]:
```
ai-knowledge-portal/
├── apps/
│   ├── frontend/          # Vue.js 3 + Vite
│   └── backend/           # Next.js + TypeScript
├── packages/
│   ├── shared/            # Shared types/utilities
│   └── config/            # Shared configuration
├── infrastructure/        # Docker, Kubernetes configs
└── docs/                  # Documentation
```

### Testing Requirements
**Testing Strategy** [Source: architecture/tech-stack.md]:
- Frontend: Vitest for unit/component testing
- Backend: Jest for API/unit testing
- E2E: Playwright for cross-browser testing
- Test files should be co-located with source code

### Technical Constraints
**Technology Stack** [Source: architecture/tech-stack.md]:
- Node.js >= 18.0.0, npm >= 9.0.0
- TypeScript 5.x throughout
- Next.js 14.x for backend
- Vue.js 3.4+ for frontend
- PostgreSQL 15+ for database
- Docker 20.0+ for containerization

**Coding Standards** [Source: architecture/coding-standards.md]:
- Type sharing through packages/shared
- No direct HTTP calls - use service layer
- Environment variables through config objects
- Prisma ORM for all database operations
- PascalCase for components, camelCase for services

### Environment Configuration
**Required Environment Variables** [Source: architecture/development-workflow.md]:
- Frontend: VITE_API_BASE_URL, VITE_APP_NAME
- Backend: DATABASE_URL, JWT_SECRET, AWS credentials
- Shared: NODE_ENV

## Testing
- **Unit Tests**: Vitest for frontend components, Jest for backend services
- **Integration Tests**: API endpoint testing with Jest
- **E2E Tests**: Playwright for critical user journeys
- **Test Location**: Co-located with source code (tests/ directories)
- **Coverage**: Aim for 80%+ coverage on new code

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2024-01-01 | 1.0 | Initial story creation | SM Agent |
| 2024-01-01 | 1.1 | Story implementation completed | Dev Agent |

## Dev Agent Record

### Agent Model Used
Claude Sonnet 4 (Developer Agent)

### Debug Log References
- Monorepo structure created successfully
- Backend Next.js project configured with TypeScript and Prisma
- Frontend Vue.js 3 project configured with PrimeVue and Pinia
- Docker configuration completed with multi-stage builds
- Testing frameworks configured (Vitest, Jest, Playwright)
- All acceptance criteria met

### Completion Notes List
- ✅ Monorepo structure with npm workspaces established
- ✅ Next.js backend with TypeScript, Prisma ORM, and health check endpoint
- ✅ PostgreSQL database schema with User, Article, FileAttachment, and Session models
- ✅ Vue.js 3 frontend with PrimeVue components, Pinia state management, and Vue Router
- ✅ Docker configuration with multi-stage builds and docker-compose for local development
- ✅ Development environment with hot reloading and concurrent server startup
- ✅ Comprehensive testing setup with Vitest (frontend), Jest (backend), and Playwright (E2E)
- ✅ Git repository initialized with proper .gitignore
- ✅ Environment configuration files and development documentation

### File List
**Root Level:**
- package.json (monorepo configuration)
- .gitignore (comprehensive ignore patterns)
- README.md (project overview and setup instructions)
- DEVELOPMENT.md (comprehensive development guide)
- docker-compose.yml (local development services)

**Backend (apps/backend/):**
- package.json (Next.js dependencies and scripts)
- tsconfig.json (TypeScript configuration)
- .eslintrc.json (ESLint configuration)
- next.config.js (Next.js configuration)
- Dockerfile (multi-stage build)
- env.example (environment variables template)
- src/pages/api/health.ts (health check endpoint)
- prisma/schema.prisma (database schema)
- prisma/migrations/20240101000000_initial/migration.sql (initial migration)
- prisma/seed.ts (database seeding)
- tests/api/health.test.ts (API endpoint test)
- tests/setup.ts (Jest test setup)
- jest.config.js (Jest configuration)

**Frontend (apps/frontend/):**
- package.json (Vue.js dependencies and scripts)
- tsconfig.json (TypeScript configuration)
- tsconfig.node.json (Node.js TypeScript configuration)
- vite.config.ts (Vite configuration)
- Dockerfile (multi-stage build)
- nginx.conf (nginx configuration for production)
- env.example (environment variables template)
- src/main.ts (application entry point)
- src/App.vue (root component)
- src/router/index.ts (Vue Router configuration)
- src/stores/auth.ts (Pinia auth store)
- src/pages/HomePage.vue (home page component)
- src/styles/main.css (global styles)
- src/styles/variables.scss (SCSS variables)
- tests/setup.ts (Vitest setup)
- tests/components/HomePage.test.ts (component test)
- tests/e2e/home.spec.ts (E2E test)
- vitest.config.ts (Vitest configuration)
- playwright.config.ts (Playwright configuration)

**Shared Packages:**
- packages/shared/package.json (shared types package)
- packages/config/package.json (shared configuration package)

## QA Results
*To be populated by QA Agent* 